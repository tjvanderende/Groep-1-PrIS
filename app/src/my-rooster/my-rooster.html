<link rel="import" href="../../bower_components/polymer/polymer.html">
<script src="../../bower_components/webcomponentsjs/webcomponents.js"></script>

<link rel='import' href='fullcalendar-styles.html' />
<link rel="import" href="../../bower_components/nebula-dialog/nebula-dialog.html">

<script src='../../bower_components/jquery/dist/jquery.min.js'></script>
<script src='../../bower_components/moment/min/moment.min.js'></script>
<script src='../../bower_components/fullcalendar/dist/fullcalendar.js'></script>

<dom-module id="my-rooster">
    <template>
      <style include="fullcalendar-styles">

      .lesInfo{
        min-width: 150px;
        max-width: 400px;
        word-wrap: break-word;
        background-color: white;
        padding: 10px;
        border-radius: 15px;
        -moz-border-radius: 15px;
      }
      .blue{
        background-color: #0066cc;
        color: white;
      }
      .red{
        background-color: #990000;
        color: white;
      }
    h3{
      margin: 5px 5px 5px 5px;
    }

</style>
      <div id="calendar"></div>
      <nebula-dialog id="dialog">
    <div class="lesInfo">
      <h3>Informatie over vandaag</h3>
      Vak: [[vakNaam]] <br>
      Docent: [[vakDocent]]<br>
      Klascode: [[klasCode]]<br>
      Begint om: [[start]]<br>
      Eindigt om: [[end]]<br><br>
      <paper-button class="blue" on-tap="bekijkPresentie" dat>Bekijk presentie</paper-button>
      <paper-button class="red" on-tap="closeModal">Sluit</paper-button>
    </div>
    </nebula-dialog>
<<<<<<< Updated upstream
      <iron-ajax url="/rooster" handle-as="json" auto on-response="handleResp"></iron-ajax>
=======

      <iron-ajax url="bestand.json" handle-as="json" auto on-response="handleResp"></iron-ajax>
>>>>>>> Stashed changes
    </template>

    <script>
        Polymer({

            is: 'my-rooster',

            properties: {
                vakNaam: {},
                vakDocent: {},
                klasCode: {},
                start: {},
                end: {},
            },
            listeners: {
                'request': 'ajaxRequest',
                'response': 'ajaxResponse'
            },

            bekijkPresentie: function() {
<<<<<<< Updated upstream
                window.location.assign("/#/systeem/presentieles/?uuid="+les.uuid);
=======
                alert("Open nu dat presentie schermpie");
>>>>>>> Stashed changes
            },

            closeModal: function() {
                this.$.dialog.close();
            },
            ajaxRequest: function() {
                $("#loader1").css("display", "block");
            },
            ajaxResponse: function() {
                $("#loader1").css("display", "none");
            },
            handleResp: function(request) {
                console.log(request.detail.response);
                var self = this;
                $(this.$.calendar).fullCalendar({
                    header: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'month,basicWeek,basicDay'
                    },
                    editable: false,
                    eventLimit: true,
                    events: request.detail.response,

                    eventClick: function(calEvent, jsEvent, view) {
<<<<<<< Updated upstream
                        les = calEvent;
                        console.log(calEvent);
=======
>>>>>>> Stashed changes
                        self.$.dialog.show();
                        self.vakNaam = calEvent.title;
                        self.vakDocent = calEvent.docent.voornaam;
                        self.klasCode = calEvent.klas.klascode;
                        self.start = calEvent._start._i;
                        self.end = calEvent._end._i;
                    }
                });
            }


        });
    </script>
</dom-module>
